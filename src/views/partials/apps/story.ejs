<% var url = "/p/" + data.hash.toLowerCase(); %>
<% var author = data.story_author; %>

<%# Separate the name into first and last name %>
<% var name = author.name.split(" "); %>

<%# Check if the profile picture is null and overwrite it with the default picture %>
<% var picture = author.picture === null ? "https://ui-avatars.com/api/?background=ff932f&bold=true&size=100&color=fff&name=" + name[0] + "+" + name[1] : "/static/users/" + author.picture; %>

<%# Check you %>
<% var you = data.you ? "true" : "false"; %>

<%# Check if user is subscribed to the topic and overwrite it with the default value %>
<% var liked = data.liked ? "true" : "false"; %>

<%# Check if the user is verified and overwrite it with the default value %>
<% var author_verified = author.verified ? "true" : "false"; %>

<%# Check if the user is following the author and overwrite it with the default value %>
<% var author_follow = author.is_following ? "true" : "false"; %>

<%# Check if bio is null and overwrite it with the default bio %>
<% var bio = author.bio === null ? "This user has not added a bio yet." : author.bio; %>

<%# Check if the story is a quick (post) story %>
<% if (data.kind === "post") { %>
<app-post story="quick" style="display: none;" tab="<%= data.tab %>" url="<%= url %>" hash="<%= data.hash %>" likes="<%= data.likes %>" 
  replies="<%= data.replies %>" liked="<%= liked %>" views="<%= data.views %>" time="<%= data.createdAt %>" replies-url="<%= url %>/replies" 
  likes-url="<%= url %>/likes" author-url="/u/<%= author.hash %>" author-hash="<%= author.hash %>" author-you="<%= you %>"
  author-img="<%= picture %>" author-verified="<%= author_verified %>" author-name="<%= author.name %>" author-followers="<%= author.followers %>"
  author-following="<%= author.following %>" author-follow="<%= author_follow %>" author-bio="<%= bio %>">
  <%= data.content %>
</app-post>
<% } else if (data.kind === "poll") { %>
<app-post story="poll" style="display: none;" tab="<%= data.tab %>" url="<%= url %>" hash="<%= data.hash %>" likes="<%= data.likes %>" 
  replies="<%= data.replies %>" liked="<%= liked %>" views="<%= data.views %>" time="<%= data.createdAt %>" voted="<%= data.option ? 'true' : 'false' %>" 
  selected="<%= data.option %>" end-time="<%= data.end %>" replies-url="<%= url %>/replies" likes-url="<%= url %>/likes" options='<%= data.poll %>' votes="<%= data.votes %>" 
  author-hash="<%= author.hash %>" author-you="<%= you %>" author-url="/u/<%= author.hash %>" author-img="<%= picture %>"
  author-verified="<%= author_verified %>" author-name="<%= author.name %>" author-followers="<%= author.followers %>" author-following="<%= author.following %>"
  author-follow="<%= author_follow %>" author-bio="<%= bio %>">
  <%= data.content %>
</app-post>
<% } else { %>
<app-story story="story" hash="<%= data.hash %>" tab="<%= data.tab %>" style="display: none;" url="<%= url %>" topics="<%= data.topics %>" story-title="<%= data.title %>" 
  time="<%= data.createdAt %>" replies-url="<%= url %>/replies" likes-url="<%= url %>/likes" replies="<%= data.replies %>" 
  liked="<%= liked %>" likes="<%= data.likes %>" views="<%= data.views %>" author-hash="<%= author.hash %>" 
  author-you="<%= you %>" author-url="/u/<%= author.hash %>" author-img="<%= picture %>" author-verified="<%= author_verified %>"
  author-name="<%= author.name %>" author-followers="<%= author.followers %>" author-following="<%= author.following %>"
  author-follow="<%= author_follow %>" author-bio="<%= bio %>">
  <%= data.content %>
</app-story>
<% } %>
